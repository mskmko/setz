<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Easy Stage Plot Maker</title>
    <style>
        /* --- ãƒ‡ã‚¶ã‚¤ãƒ³è¨­å®š (CSS) --- */
        body {
            font-family: "Helvetica Neue", Arial, sans-serif;
            background-color: #1a1a1a;
            /* èƒŒæ™¯ï¼šãƒ€ãƒ¼ã‚¯ã‚°ãƒ¬ãƒ¼ */
            color: #ffffff;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        h1 {
            margin-bottom: 10px;
            font-size: 1.5rem;
        }

        p {
            color: #aaaaaa;
            font-size: 0.9rem;
            margin-bottom: 20px;
        }

        /* ã‚¹ãƒ†ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ */
        #stage-area {
            width: 90%;
            max-width: 600px;
            height: 400px;
            background-color: #333;
            border: 2px solid #555;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            background-image: linear-gradient(#444 1px, transparent 1px), linear-gradient(90deg, #444 1px, transparent 1px);
            background-size: 20px 20px;
            /* ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º */
            margin-bottom: 20px;
        }

        .stage-label {
            position: absolute;
            color: #555;
            font-weight: bold;
            pointer-events: none;
            font-size: 2rem;
            opacity: 0.5;
        }

        /* ã‚¢ã‚¤ã‚³ãƒ³ (æ©Ÿæ) */
        .gear-item {
            width: 50px;
            height: 50px;
            background-color: #00d1b2;
            /* åˆæœŸã®æ©Ÿæè‰² */
            border-radius: 5px;
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: grab;
            user-select: none;
            font-size: 0.8rem;
            font-weight: bold;
            color: #fff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            text-align: center;
        }

        .gear-item:active {
            cursor: grabbing;
        }

        /* æ©Ÿæãƒ‘ãƒ¬ãƒƒãƒˆ (ãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢) */
        .palette {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }

        .add-btn {
            padding: 8px 12px;
            background-color: #444;
            color: #fff;
            border: 1px solid #666;
            border-radius: 4px;
            cursor: pointer;
            transition: 0.2s;
        }

        .add-btn:hover {
            background-color: #555;
        }

        /* å…¥åŠ›ã‚¨ãƒªã‚¢ */
        .details-section {
            width: 90%;
            max-width: 600px;
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .gear-row {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            align-items: center;
        }

        .gear-row input {
            background: #444;
            border: none;
            color: white;
            padding: 8px;
            border-radius: 4px;
            flex: 1;
        }

        .remove-btn {
            background: #ff3860;
            color: white;
            border: none;
            border-radius: 4px;
            padding: 5px 10px;
            cursor: pointer;
        }

        textarea {
            width: 100%;
            height: 80px;
            background: #444;
            border: none;
            color: white;
            padding: 10px;
            border-radius: 4px;
            box-sizing: border-box;
            margin-top: 10px;
        }

        /* ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒœã‚¿ãƒ³ */
        .actions {
            display: flex;
            gap: 15px;
        }

        .action-btn {
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: bold;
            border: none;
            border-radius: 30px;
            cursor: pointer;
        }

        .btn-print {
            background-color: #3273dc;
            color: white;
        }

        .btn-copy {
            background-color: #23d160;
            color: white;
        }

        /* å°åˆ·æ™‚ã®ã‚¹ã‚¿ã‚¤ãƒ«èª¿æ•´ */
        @media print {
            body {
                background-color: white;
                color: black;
                -webkit-print-color-adjust: exact;
            }

            .palette,
            .actions,
            .remove-btn {
                display: none;
            }

            #stage-area {
                border: 2px solid black;
                background-color: white;
            }

            .gear-item {
                border: 1px solid black;
                color: black;
            }

            input,
            textarea {
                border: 1px solid #ccc;
                background: white;
                color: black;
            }
        }
    </style>
</head>

<body>

    <h1>BAND STAGE PLOT</h1>
    <p>æ©Ÿæã‚’è¿½åŠ ã—ã¦é…ç½®ã—ã€è©³ç´°ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>

    <div class="palette">
        <button class="add-btn" onclick="addGear('Dr', '#ffdd57', 80)">ğŸ¥ Drums</button>
        <button class="add-btn" onclick="addGear('Gt Amp', '#3273dc', 50)">ğŸ¸ Gt Amp</button>
        <button class="add-btn" onclick="addGear('Ba Amp', '#209cee', 50)">ğŸ¸ Ba Amp</button>
        <button class="add-btn" onclick="addGear('Vo Mic', '#ff3860', 30)">ğŸ¤ Vocal</button>
        <button class="add-btn" onclick="addGear('DI', '#00d1b2', 40)">ğŸ¹ DI/Key</button>
        <button class="add-btn" onclick="addGear('Monitor', '#bbbbbb', 40, true)">ğŸ”Š Monitor</button>
    </div>

    <div id="stage-area">
        <div class="stage-label" style="top: 10px; left: 10px;">Shimote (ä¸‹æ‰‹)</div>
        <div class="stage-label" style="top: 10px; right: 10px;">Kamite (ä¸Šæ‰‹)</div>
        <div class="stage-label" style="bottom: 10px; width: 100%; text-align: center;">Audience (å®¢å¸­)</div>
    </div>

    <div class="details-section">
        <h3>ğŸ“‹ æ©Ÿæ & è¦æœ›ãƒªã‚¹ãƒˆ</h3>
        <div id="gear-list">
            <p style="font-size: 0.8rem; color: #777;">ä¸Šã®ãƒœã‚¿ãƒ³ã§æ©Ÿæã‚’è¿½åŠ ã™ã‚‹ã¨ã€ã“ã“ã«å…¥åŠ›æ¬„ãŒã§ãã¾ã™ã€‚</p>
        </div>

        <h3>ğŸ“ å…¨ä½“é€£çµ¡äº‹é …ãƒ»ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆ</h3>
        <textarea id="general-notes" placeholder="ä¾‹ï¼šãƒ‰ãƒ©ãƒ ã®ã‚¿ãƒ ã¯2ã¤ã§ã™ã€‚å…¨ä½“çš„ã«ãƒªãƒãƒ¼ãƒ–æ·±ã‚ã§ãŠé¡˜ã„ã—ã¾ã™ã€‚
1. Song A
2. Song B..."></textarea>
    </div>

    <div class="actions">
        <button class="action-btn btn-print" onclick="window.print()">ğŸ–¨ï¸ PDFä¿å­˜ / å°åˆ·</button>
        <button class="action-btn btn-copy" onclick="copyText()">ğŸ“‹ ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>

    <script>
        let gearCount = 0;
        const stageArea = document.getElementById('stage-area');
        const gearList = document.getElementById('gear-list');

        // æ©Ÿæã‚’è¿½åŠ ã™ã‚‹é–¢æ•°
        function addGear(name, color, size, isMonitor = false) {
            gearCount++;
            const id = `gear-${gearCount}`;

            // 1. ã‚¹ãƒ†ãƒ¼ã‚¸ä¸Šã®ã‚¢ã‚¤ã‚³ãƒ³ä½œæˆ
            const el = document.createElement('div');
            el.classList.add('gear-item');
            el.id = id;
            el.innerText = name;
            el.style.backgroundColor = color;
            el.style.width = size + 'px';
            el.style.height = (isMonitor ? size / 2 : size) + 'px'; // ãƒ¢ãƒ‹ã‚¿ãƒ¼ã¯å¹³ãŸã
            el.style.top = '50%';
            el.style.left = '50%';

            // ãƒ‰ãƒ©ãƒƒã‚°ç§»å‹•ã®ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
            setupDraggable(el);
            stageArea.appendChild(el);

            // 2. è¦æœ›ãƒªã‚¹ãƒˆã«å…¥åŠ›æ¬„ã‚’è¿½åŠ 
            if (gearCount === 1) gearList.innerHTML = ''; // èª¬æ˜æ–‡ã‚’æ¶ˆã™

            const row = document.createElement('div');
            row.classList.add('gear-row');
            row.id = `row-${id}`;
            row.innerHTML = `
                <span style="width: 60px; font-weight:bold;">${name}</span>
                <input type="text" id="input-${id}" placeholder="è©³ç´° (ä¾‹: SM58, æŒã¡è¾¼ã¿...)" oninput="updateLabel('${id}', this.value)">
                <button class="remove-btn" onclick="removeGear('${id}')">Ã—</button>
            `;
            gearList.appendChild(row);
        }

        // æ©Ÿæã‚’å‰Šé™¤ã™ã‚‹é–¢æ•°
        function removeGear(id) {
            document.getElementById(id).remove(); // ã‚¹ãƒ†ãƒ¼ã‚¸ã‹ã‚‰å‰Šé™¤
            document.getElementById(`row-${id}`).remove(); // ãƒªã‚¹ãƒˆã‹ã‚‰å‰Šé™¤
        }

        // ãƒ©ãƒ™ãƒ«æ›´æ–°ï¼ˆå…¥åŠ›å†…å®¹ã‚’ã‚¢ã‚¤ã‚³ãƒ³ã®titleå±æ€§ã«å…¥ã‚Œã‚‹ãªã©ã®æ‹¡å¼µç”¨ï¼‰
        function updateLabel(id, text) {
            // å¿…è¦ã§ã‚ã‚Œã°ã‚¢ã‚¤ã‚³ãƒ³ä¸Šã«æ–‡å­—ã‚’è¡¨ç¤ºã™ã‚‹ãªã©ã®å‡¦ç†ã‚’ã“ã“ã«è¿½åŠ 
        }

        // ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ (PC/ã‚¹ãƒãƒ›ä¸¡å¯¾å¿œã®ç°¡æ˜“ç‰ˆ)
        function setupDraggable(elmnt) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;

            elmnt.onmousedown = dragMouseDown;
            elmnt.ontouchstart = dragMouseDown; // ã‚¹ãƒãƒ›å¯¾å¿œ

            function dragMouseDown(e) {
                e = e || window.event;
                e.preventDefault();
                // é–‹å§‹ä½ç½®ã‚’å–å¾—
                if (e.type === 'touchstart') {
                    pos3 = e.touches[0].clientX;
                    pos4 = e.touches[0].clientY;
                } else {
                    pos3 = e.clientX;
                    pos4 = e.clientY;
                }

                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
                document.ontouchend = closeDragElement;
                document.ontouchmove = elementDrag;
            }

            function elementDrag(e) {
                e = e || window.event;
                // æ–°ã—ã„ä½ç½®ã‚’è¨ˆç®—
                let clientX, clientY;
                if (e.type === 'touchmove') {
                    clientX = e.touches[0].clientX;
                    clientY = e.touches[0].clientY;
                } else {
                    clientX = e.clientX;
                    clientY = e.clientY;
                }

                pos1 = pos3 - clientX;
                pos2 = pos4 - clientY;
                pos3 = clientX;
                pos4 = clientY;

                // ç¯„å›²å¤–ã«å‡ºãªã„ã‚ˆã†ã«åˆ¶é™
                let newTop = (elmnt.offsetTop - pos2);
                let newLeft = (elmnt.offsetLeft - pos1);

                // ã‚¹ãƒ†ãƒ¼ã‚¸æ å†…ã«åã‚ã‚‹ç°¡æ˜“è¨ˆç®—
                const stageRect = stageArea.getBoundingClientRect();
                if (newTop < 0) newTop = 0;
                if (newLeft < 0) newLeft = 0;
                if (newTop > stageArea.offsetHeight - elmnt.offsetHeight) newTop = stageArea.offsetHeight - elmnt.offsetHeight;
                if (newLeft > stageArea.offsetWidth - elmnt.offsetWidth) newLeft = stageArea.offsetWidth - elmnt.offsetWidth;

                elmnt.style.top = newTop + "px";
                elmnt.style.left = newLeft + "px";
            }

            function closeDragElement() {
                // ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†
                document.onmouseup = null;
                document.onmousemove = null;
                document.ontouchend = null;
                document.ontouchmove = null;
            }
        }

        // ãƒ†ã‚­ã‚¹ãƒˆã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        function copyText() {
            let text = "ã€ãƒãƒ³ãƒ‰ ã‚¹ãƒ†ãƒ¼ã‚¸å›³ãƒ»å›ç·šè¡¨ã€‘\n\n";
            const rows = document.querySelectorAll('.gear-row');
            rows.forEach(row => {
                const name = row.querySelector('span').innerText;
                const val = row.querySelector('input').value;
                text += `â–  ${name}: ${val}\n`;
            });
            text += `\nã€é€£çµ¡äº‹é …ã€‘\n${document.getElementById('general-notes').value}`;

            navigator.clipboard.writeText(text).then(() => {
                alert("ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼LINEã‚„ãƒ¡ãƒ¼ãƒ«ã«è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚");
            });
        }
    </script>
</body>

</html>